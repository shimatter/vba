Sub 張付用シート内削除()
    Application.ScreenUpdating = False
    Application.DisplayAlerts = False
    
    Sheets("貼付用").Cells.Delete
    
End Sub


Sub エリアフラグ挿入()
    Application.ScreenUpdating = False
    Application.DisplayAlerts = False
    
    Sheets("貼付用").Select
    colums("B:B").Select
    Selection.TextToColumns dwstination:=Range("B1"), DataType:=delimited, _
    textqualifier:=xlDoubleQuote, consecutivedelimiter:=False, Tab:=True, _
    semicolon:=False, comma:=False, Space:=False, other:=False, fieldinfo _
    :=Array(1, 1), trailingminusnumbers:=True
    
    Dim i As Long
    
        Sheets("貼付用").Range("E:G").Delete
        
        Sheets("貼付用").Range("E1").Value = "エリアフラグ"
        Sheets("貼付用").Range("E:E").Interior.ColorIndex = 6
        
    For i = 2 To Sheets("貼付用").Cells(Rows.Count, "A").End(xlUp).Row
        Sheets("貼付用").Cells(i, "E") = Application.VLookup(Sheets("貼付用") _
        .Cells(i, "B"), Sheets("参照用").Range("A1:BB5"), 2, 0)
        
    Next i
End Sub


Sub 借用BC削除()
    Application.ScreenUpdating = False
    Application.DisplayAlerts = False
    
    shees("完成BC（借）").Cells.ClearContents
    
End Sub


Sub 借用BC作成()
    Application.ScreenUpdating = False
    
    Call 借用BC削除
    
    '対象のエリアを変数で設定
    Dim エリア As Long
    エリア = InputBox("作成するエリアを入力して下さい")
    
    'BC用に管理番号の分割処理
    '必要なエリアをダイアログに入力し、出力する
    Sheets("貼付用").Select
    Sheets("貼付用").Range("A1", Cells(Rows.Count, "E").End(xlUp)).AutoFilter field:=5, Criteria1:="エリア"
    
    Sheets("貼付用").Range("A2", Cells(Rows.Count, "D").End(xlUp)).Copy
    Sheets("完成BC（借）").Range("A1").PasteSpecial
    
    Workbooks.Add
    ActiveSheet.SaveAs Filename:=Workbooks("三鷹用シール作成用マクロ.xlsm").Path _
    & "\【シール】三鷹分_月作業分_月作業分_" & エリア & ".csv", FileFormat:=xlCSV, CreateBackup:=False
    
    Workbooks("三鷹用シール作成用マクロ.xlsm").Sheets("完成BC（借）").Copy _
    Workbooks("【シール】三鷹分_月作業分_月作業分_" & エリア & ".csv").Sheets(1)
    
    ActiveWorkbook.Save
    ActiveWorkbook.Close
    
End Sub

